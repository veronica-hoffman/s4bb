field = 2
year = 20
band = HF-1
nlat = 3
r bias tolerance = 0.0001
max bias search = 5.0%
using 10 realizations for testing
loading unbiased results from: mlsearch/ph2_mlsearch_f2_y20_n3_diag0_full_withpbs.npy
using full bands
using performance-based scaling

Loading existing unbiased ML search results...
Loaded 99 realizations from mlsearch/ph2_mlsearch_f2_y20_n3_diag0_full_withpbs.npy
Using 10 realizations for tolerance search
Realization indices: [0 1 2 3 4 5 6 7 8 9]

Reading data...

Finding bias tolerance for HF-1...
Baseline r mean from existing data: 0.001714
Searching for positive bias tolerance...
Applied +2.5% bias to HF-1:
  Original: (198.0, 256.0) GHz
  Biased:   (202.9, 262.4) GHz
/global/u1/v/vhoffman/reproduce_colin_results/phase2_common.py:193: RuntimeWarning: invalid value encountered in arccos
  ang = np.arccos(x * x0 + y * y0 + z * z0)
  Testing 2.5%: r_bias = 0.000538
Applied +1.2% bias to HF-1:
  Original: (198.0, 256.0) GHz
  Biased:   (200.5, 259.2) GHz
  Testing 1.2%: r_bias = 0.000276
Applied +0.6% bias to HF-1:
  Original: (198.0, 256.0) GHz
  Biased:   (199.2, 257.6) GHz
  Testing 0.6%: r_bias = 0.000206
Applied +0.3% bias to HF-1:
  Original: (198.0, 256.0) GHz
  Biased:   (198.6, 256.8) GHz
  Testing 0.3%: r_bias = 0.000070
Applied +0.5% bias to HF-1:
  Original: (198.0, 256.0) GHz
  Biased:   (198.9, 257.2) GHz
  Testing 0.5%: r_bias = 0.000102
Applied +0.4% bias to HF-1:
  Original: (198.0, 256.0) GHz
  Biased:   (198.8, 257.0) GHz
/global/u1/v/vhoffman/reproduce_colin_results/s4bb/models.py:629: RuntimeWarning: invalid value encountered in sqrt
  np.sqrt(param[0] * param[5] * dust_ell_scale *
  Testing 0.4%: r_bias = 0.000080
Searching for negative bias tolerance...
Applied -2.5% bias to HF-1:
  Original: (198.0, 256.0) GHz
  Biased:   (193.0, 249.6) GHz
  Testing -2.5%: r_bias = -0.000181
Applied -1.2% bias to HF-1:
  Original: (198.0, 256.0) GHz
  Biased:   (195.5, 252.8) GHz
  Testing -1.2%: r_bias = -0.000214
Applied -0.6% bias to HF-1:
  Original: (198.0, 256.0) GHz
  Biased:   (196.8, 254.4) GHz
  Testing -0.6%: r_bias = -0.000127
Applied -0.3% bias to HF-1:
  Original: (198.0, 256.0) GHz
  Biased:   (197.4, 255.2) GHz
  Testing -0.3%: r_bias = -0.000067
Applied -0.5% bias to HF-1:
  Original: (198.0, 256.0) GHz
  Biased:   (197.1, 254.8) GHz
  Testing -0.5%: r_bias = -0.000095
Applied -0.5% bias to HF-1:
  Original: (198.0, 256.0) GHz
  Biased:   (196.9, 254.6) GHz
  Testing -0.5%: r_bias = -0.000056

Final result for HF-1: [-0.55%, +0.39%]
Results saved to bandpass_tolerance/ph2_tolerance_f2_y20_n3_diag0_full_withpbs_HF-1_rtol1e-04_nrlz10.npy
	Command being timed: "python -u bandpass_tolerance.py 2 20 HF-1 --unbiased-file mlsearch/ph2_mlsearch_f2_y20_n3_diag0_full_withpbs.npy --pbs --r-bias-tol 0.0001 --n-realizations 10"
	User time (seconds): 25278.56
	System time (seconds): 9.95
	Percent of CPU this job got: 413%
	Elapsed (wall clock) time (h:mm:ss or m:ss): 1:41:59
	Average shared text size (kbytes): 0
	Average unshared data size (kbytes): 0
	Average stack size (kbytes): 0
	Average total size (kbytes): 0
	Maximum resident set size (kbytes): 1710644
	Average resident set size (kbytes): 0
	Major (requiring I/O) page faults: 226
	Minor (reclaiming a frame) page faults: 4301013
	Voluntary context switches: 261517
	Involuntary context switches: 55895
	Swaps: 0
	File system inputs: 0
	File system outputs: 0
	Socket messages sent: 0
	Socket messages received: 0
	Signals delivered: 0
	Page size (bytes): 4096
	Exit status: 0
